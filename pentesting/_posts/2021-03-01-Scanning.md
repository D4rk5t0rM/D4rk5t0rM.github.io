The second phase of the an attack: Scanning

# disclaimer
Not all tools/files/VMs/networks will be available. These are notes taken for labs duiring a course, so some stuff is copyright protected and can't be shared. Where possible I'll try to link the resources.

Network Range: 	10.11.0.1 - 10.11.1.254

All nmap scans **should** and are done with **root privileges**.

# question 1 - your IP:
``ip a`` -> tap0 -> inet: 10.11.1.32/23 -> flag: 10.11

# question 2 - DNS 1:
``sudo nmap 10.11.0.1-100`` -> look for port 53 DNS (and probably the first DNS server) -> flag: 10.11.0.19

# question 3 - DNS 2:
``sudo nmap 10.11.0.1-100`` -> look for port 53 DNS (and probably the second DNS server) -> flag: 10.11.0.28

# question 4 - live addresses:
* nmap pingsweep: (running nmap as non root user) ``nmap -sn 10.11.0.1-100`` -> 7 adr; wich is wrong
* nmap stealth scan as root: ``sudo nmap -sn 10.11.0.1-100`` this did get 9 IP's
  * **Running NMAP with root privileges is very important; it's faster AND can discover more IP's**

# question 5 - DC:
``nbtscan 10.11.0.1-100`` -> DC has ip 10.11.0.19 -> flag: 10.11.0.19

# question 6 - hostname:
``sudo nmap 10.11.0.1-100`` -> highest IP= .53 -> has hostname ``www.officehustler.be``

# question 7 - router:
The original nmap scan: ``MAC Address: 6C:3B:6B:78:64:AA (Routerboard.com)`` is probably the router; -> ip: ``10.11.0.24``

# question 8 - router software:
Nmap showed us that there is an open port 80 & 443 on the router; use the browser and go to there and look at what it says. This is a ``pfsense`` router.

# question 9 - HTTP:
``sudo nmap 10.11.0.1-100 -p80 | grep open `` -> flag 4

# question 10 - HTTPS:
``sudo nmap 10.11.0.1-100 -p443 | grep open `` -> flag 3

# question 11 - how many windows systems?
* port TCP/135(msrpc) is a windows exclusive port; so every open port on this network is a windows system:
  * ``nmap -n 10.11.0.1-100 -p135 --open`` (nmap scan only open ports of port 135 tcp) - 4 Open ports

# question 12 - Exact Server OS of the ip 10.11.0.28:
``nmap -n 10.11.0.28 -O -sV -p445``
* -n: don't resolve names; this makes nmap a lot faster.
* -O: to identify the os
* -sV: for a banner grab
* -p: for one common MS port to speed things up
* -> nmap unreliably sais it could be: ``Microsoft Windows Home Server 2011 (Windows Server 2008 R2) (96%),`` it's very hard to find out but it could give some insights.

# question 13 - find the exact version number (integer: eg. 102366) of the portable windows device:
Portable windows device = a laptop. I found this by running a ``nmap -A 10.11.0.1-100 -T4`` scan over the whole network; there are references to ``MSI`` and ``LAPTOP-695AFE`` wich is our laptop, one of the nmap scripts enumerated the windows version: ``OS: Windows 10 Pro 10586 (Windows 10 Pro 6.3)``.

# question 14 - hidden website; https website on 10.11.0.53 running on a non default port what is that port 
``nmap -n 10.11.0.53`` - again the ``-n`` for making nmap a bit quikcer (by not using DNS name resolve)
-> port 8443 is a common non default https port.
-> to confirm if it is really a webserver; you can go to it with the browser.

# question 15 - how many different ssh fingerprints are on the raspberrypi? (ip: 10.11.0.53)
* slow and dirty way: ``nmap -n 10.11.0.53 -p- -sV`` doing a full port scan with bannergrabbing
* quicker way is to identify first what might be a ssh server and instead of doing the bannergrab on all the ports; do it on just the ports you think might be ssh: `` nmap -n 10.11.0.53 -p22,2210,2211,2212,2214,2222 -sV``

# Question 16 - Use nessus to find a critical CVE on a windows machine:
Nessus scan -> Microsoft Windows -> ``[Critical] Microsoft DNS Server Remote Code Execution (SIGRed)`` -> reference information -> ``CVE-2020-1350``
