# Setup & intitial test
In this Lab we'll set up a AVD and do some initial testing to get to know the Android file system.

# Setup:
## Download Android studio:
[android studio](https://developer.android.com/studio)

## Install Android Studio
follow the installation steps; make sure to download the SDK too

## virtual emulator:
Import the AVD (don't change the names)

## start AVD
click on the green arrow

#Start lab:
## test the ADB connection 
If the device is powered on you can use the ``adb devices`` command and there will be a device called "emulator-****".

## Copy a .txt file to the device, edit this file in the shell and copy back to the host.
1. ``abd push test.txt`` will not work because the device is read only. We'll have to look for a part where we can write. 
    * Using ``abd shell`` I got a shell on the device and i went through different folders using the ``cd`` & ``ls`` command I tested different folders if I could write with ``touch t``. I found one folder I was able to write to ``/mnt/media_rw`` this is the folder we'll use.
2. ``adb push test.txt /mnt/media_rw`` This did not give me an error
3. editing the file in the shell: 
    * there is no vim/vi program so the only way to edit a file is by using the ``>>`` to append to it of ``>`` to overwrite.
	* when we are back in the shell and in the writeable folder we can do ``echo shell >> test.txt`` this appends to the file.
	* validating with ``cat test.txt`` we can see the text from the ``test.txt`` file and the newly appended *"shell"* in this file
4. copy it back:
	* When outside the shell we can use the ``adb pull`` command to get a file:
	* ``adb pull /mnt/media_rw/test.txt``
	* verify if it is the right file by useing ``cat text.txt`` on the host device. This should show the file with the appended *"shell"* in it.
	
## Create a screenshot with adb and store it on the host.
The screenshot tool in adb is called ``screencap``. Using the command ``adb shell screencap -p /mnt/media_rw/screenshot.png`` we can create a screenshot of the current screen and store it wherever we want.
* The pull command can be used to retrieve the screenshot just like we did with the text file.

## Installing APKs
using ``adb install .\app-x86-debug.apk`` & ``adb install .\rootchecker.apk`` we can install 2 applications on the device.

## Running the APKs - NOT COMPLETE
we can not run the APKs because there is a lock on the device. There is a way to run apps from the shell but you need to know the full app name for that a command like that would look like this: ``adb shell am start -n com.google.android.setupwizard/.SetupWizardTestActivity`` [stackoverflow "how to run adb shell"](https://stackoverflow.com/questions/47650987/how-to-run-adb-shell)

We will be removing the lock from the device so we can use the GUI.

In the ``/data/system/`` folder there should be a ``recoverablekeystore.db`` file, I found this by using the ``ls | grep key`` command and by using the internet. We can rename that file to make it inactive and still keep it as a backup: ``mv recoverablekeystore.db recoverablekeystore.db.bck``
[does not help rm locksettings.db](https://android.stackexchange.com/questions/224407/reset-pin-from-adb-shell)

## list all running processes
``adb shell ps`` (DO NOT go into shell and run PS, does not show all)